<Page x:Class="ReadMangaApp.View.MangaDetailPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:ReadMangaApp.View"
      mc:Ignorable="d" 
      Title="MangaDetailPage">
    <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,5">
        <Grid Background="Transparent">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Border BorderThickness="1" CornerRadius="5" MaxWidth="290" HorizontalAlignment="Left" VerticalAlignment="Top">
                <Border.Background>
                    <SolidColorBrush Color="White" Opacity="0.8"/>
                </Border.Background>
                <StackPanel>
                    <StackPanel Margin="5">
                        <Image Width="270" Height="400" Source="{Binding SelectedManga.CoverUrl}" Stretch="Fill"/>
                        <WrapPanel Margin="0,10,0,0">
                            <Button Content="Добавить в коллекцию" Width="225" Command="{Binding AddToCollectionCommand}"/>
                            <ComboBox x:Name="CollectionsComboBox"
             Width="45"
             ItemsSource="{Binding Collections}"
             DisplayMemberPath="Title"
             SelectedValuePath="Id"
             SelectedValue="{Binding SelectedCollectionId, Mode=TwoWay}"
             DropDownOpened="CollectionsComboBox_DropDownOpened"/>
                        </WrapPanel>
                    </StackPanel>
                    <StackPanel Margin="10">
                        <TextBlock Text="{Binding SelectedManga.DatePublished, StringFormat='Выпуск: {0} г'}" FontSize="14" Margin="0,0,0,5"/>
                        <TextBlock Text="{Binding SelectedManga.StatusReleased.Name, StringFormat='Статус: {0}'}" FontSize="14" Margin="0,0,0,5"/>
                        <TextBlock Text="{Binding SelectedManga.StatusTranslation.Name, StringFormat='Перевод: {0}'}" FontSize="14" Margin="0,0,0,5"/>
                        <TextBlock Text="{Binding SelectedManga.Author, StringFormat='Автор: {0}'}" FontSize="14" Margin="0,0,0,5"/>
                        <TextBlock Text="Издатели:" FontSize="14" Margin="0,0,5,5"/>
                        <WrapPanel>
                            <ItemsControl ItemsSource="{Binding Publishers}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Margin="0,0,5,5">
                                            <TextBlock Text="{Binding Name}" FontSize="14"/>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </WrapPanel>
                    </StackPanel>
                </StackPanel>
            </Border>
            <StackPanel Grid.Column="1" Margin="10,5">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{Binding SelectedManga.Name}" FontWeight="Bold" FontSize="26" VerticalAlignment="Center" Grid.Column="0"/>
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Bottom" Grid.Column="1">
                        <Image Source="/Icons/star.png" Width="20" Height="20"></Image>
                        <TextBlock Text="{Binding MangaScores.AverageScore, StringFormat={}{0:F1}}" FontSize="18" VerticalAlignment="Center"/>
                        <Button Content="Оценить" Margin="10,0,0,0" Command="{Binding OpenScorePageCommand}"></Button>
                    </StackPanel>
                </Grid>
                <TextBlock Text="{Binding SelectedManga.AlternativeTitle}" FontSize="16"/>

                <WrapPanel Margin="0,10,0,0">
                    <Button Content="О тайтле" Command="{Binding OpenMangaInfoPageCommand}"></Button>
                    <Button Content="Главы" Command="{Binding OpenChaptersPageCommand}"></Button>
                    <Button Content="Комментарии"></Button>
                    <Button Content="Отзывы"></Button>
                </WrapPanel>
                <Frame x:Name="MangaDetailContent" Height="Auto"></Frame>
            </StackPanel>
        </Grid>
    </ScrollViewer>
</Page>
